<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="/img/iconos/salud.png" type="image/png">        
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/perfiles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.js"></script>
  <title>Próximas citas</title>
</head>
<body>
  
  <%- include('./partials/header'); %>
  <%- include('./partials/navbarMedico'); %>
  <%- include('./partials/footer'); %>
  
  <div class="container d-flex justify-content-center">
      <div class="card bg-custom-card text-white mt-3" style="border-radius: 1rem;">
        <div class="card-body text-center">
          <h1 class="mb-4 text-center">Próximas citas</h1>
          <div class="row">
            <div class = "col">
              <form class = "formCuerpo" id="todasLista" method=" POST">
                <button type="submit" class="btn btn-primary mb-3 mt-3 ms-3" title="listaCitas" id="botonTodas" onclick="cambioColorCita('botonTodas')">Todas</button>
              </form>
            </div>
            <div class = "col">
                <form class = "formCuerpo" id="listaPresen" method=" POST">
                  <button type="submit" class="btn btn-primary mb-3 mt-3 ms-3" title="presencial" id="botonPresencia" onclick="cambioColorCita('botonPresencia')">Presenciales</button>
                </form>
            </div>
            <div class = "col">
                <form class = "formCuerpo" id="listaTelef" method=" POST">
                  <button type="submit" class="btn btn-primary mb-3 mt-3 ms-3" title="telefonica" id="botonTelefonica" onclick="cambioColorCita('botonTelefonica')">Telefónicas</button>
                </form>
            </div>
            <div class = "col">
                <form class = "formCuerpo" id="listaVideo" method=" POST">
                  <button type="submit" class="btn btn-primary mb-3 mt-3 ms-3" title="videoconferencia" id="botonVideo" onclick="cambioColorCita('botonVideo')">Videoconferencias</button>
                </form>
            </div>
          </div>
          <br>
          <form class="d-flex align-items-center">
            <input class="form-control me-2 " type="buscar" placeholder="Buscar" aria-label="Buscar" id="buscar">
            <button class="btn btn-dark" type="submit"><img src="/img/iconos/lupa.png"width="20" height="20"></button>
          </form>
          <br>
          <button type="button" class="btn btn-primary mb-4" id="pdfout" onclick="imprimirContenido()">Descargar lista completa</button>
          <table class="table tablaCitas ">
            <thead id ="headListaCitas"></thead>
            <tbody id ="tablaListaCitas" style="vertical-align: middle;"></tbody>
          </table>
        </div>
      </div>
  </div>

  <%- include('./modals/mModificarCita'); %>
  
  <div class="resto2"></div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="/javascript/scriptsReservarCita.js" type="text/javascript"></script>
  <script src="/javascript/scripts.js" type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


  <script>
    window.jsPDF = window.jspdf.jsPDF;
    function imprimirContenido() {

      // Obtener la tabla de citas HTML
      var maintable = document.getElementById('tablaListaCitas');
      var pdfout = document.getElementById('pdfout');

      pdfout.onclick = function () {
        // generamos el PDF, p = portrait, en vertical
        // pt = points, conteo de puntos; y a4 = tamaño del papel
        var doc = new jsPDF('p', 'pt', 'a4');
        var margin = 20;
        var scale = 2 * ((doc.internal.pageSize.width - margin * 2) / document.body.clientWidth);

        if(window.innerWidth > 768) {
          doc.html(maintable, {
              x:margin,
              y:margin,
              html2canvas:{
                scale: scale,
              },
              callback: function(doc) {
                doc.save('Próximas citas.pdf');
              }
          })
        }
      }
    }
  </script>
</body>
</html>